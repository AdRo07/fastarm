fastarm

This toolkit contains a set of fast memcpy variants for ARM platforms.
They uses the standard register file, VFP or NEON registers are not
used.

Several basic families of variants are provided; the latest ones are
the "new memcpy" variants which are the default for memcpy replacement,
which generally do not overfetch beyond the source region and can be
configured to use unaligned memory access for small sizes, or to use
strictly aligned memory access. This family can also be configured to
include a fast path for smaller sizes (this is the default), disabling
this results in smaller code size at the expense of worse performance
for small sizes.

To compile the benchmark program, run 'make'. This will compile in a
plethora of variants with different preload strategies, block sizes,
alignment etc.

A benchmark program to compare various memcpy variants is provided. Try
something like "./benchmark --memcpy ac --all". (Use --memcpy ah on the
Raspberry Pi platform).

To compile a memcpy replacement library, set PLATFORM to one of the
following values in the Makefile:

    SUNXI    Allwinner platform (tested on A10).
    RPI      Raspberry Pi

Optionally disable Thumb2 mode compilation by commenting out the THUMBFLAGS
definition. It must be disabled on the Raspberry Pi.

Then run:

    sudo make install_memcpy_replacement

The replacement memcpy shared library will be installed into
/usr/lib/arm-linux-gnueabihf/ as libfastarm.so. The variant used is currently
from the new family with line size, write alignment and preload offset
optimized for the platform. A memset replacement is also provided.

To enable the use of the replacement memcpy in applications, create or edit
the file /etc/ld.so.preload so that it contains the line:

    /usr/lib/arm-linux-gnueabihf/libfastarm.so

On the RPi platform, references to libcofi_rpi.so should be commented out
or deleted. The new memcpy should now be activated for newly launched
programs. To be sure, reboot or run:

    sudo ldconfig

To revert to the default optimized memcpy on the RPi platform,
edit /etc/ld.so.preload so that it contains the line:

    /usr/lib/arm-linux-gnueabihf/libcofi_rpi.so

instead of the one using libfastarm.so.
